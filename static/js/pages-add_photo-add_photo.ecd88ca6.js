(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-add_photo-add_photo"],{"04d1":function(e,t,i){"use strict";var a=i("4ea4");i("4de4"),i("d81d"),i("45fc"),i("d3b7"),i("ac1f"),i("1276"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i("b69b"),o=a(i("67bd")),u=a(i("e600")),r={name:"u-upload",mixins:[uni.$u.mpMixin,uni.$u.mixin,o.default,u.default],data:function(){return{lists:[],isInCount:!0}},watch:{fileList:{immediate:!0,handler:function(){this.formatFileList()}}},methods:{formatFileList:function(){var e=this,t=this.fileList,i=void 0===t?[]:t,a=this.maxCount,n=i.map((function(t){return Object.assign(Object.assign({},t),{isImage:"image"===e.accept||uni.$u.test.image(t.url||t.thumb),isVideo:"video"===e.accept||uni.$u.test.video(t.url||t.thumb),deletable:"boolean"===typeof t.deletable?t.deletable:e.deletable})}));this.lists=n,this.isInCount=n.length<a},chooseFile:function(){var e=this,t=this.maxCount,i=this.multiple,a=this.lists,o=this.disabled;if(!o){var u;try{u=uni.$u.test.array(this.capture)?this.capture:this.capture.split(",")}catch(r){u=[]}(0,n.chooseFile)(Object.assign({accept:this.accept,multiple:this.multiple,capture:u,compressed:this.compressed,maxDuration:this.maxDuration,sizeType:this.sizeType,camera:this.camera},{maxCount:t-a.length})).then((function(t){e.onBeforeRead(i?t:t[0])})).catch((function(t){e.$emit("error",t)}))}},onBeforeRead:function(e){var t=this,i=this.beforeRead,a=this.useBeforeRead,n=!0;uni.$u.test.func(i)&&(n=i(e,this.getDetail())),a&&(n=new Promise((function(i,a){t.$emit("beforeRead",Object.assign(Object.assign({file:e},t.getDetail()),{callback:function(e){e?i():a()}}))}))),n&&(uni.$u.test.promise(n)?n.then((function(i){return t.onAfterRead(i||e)})):this.onAfterRead(e))},getDetail:function(e){return{name:this.name,index:null==e?this.fileList.length:e}},onAfterRead:function(e){var t=this.maxSize,i=this.afterRead,a=Array.isArray(e)?e.some((function(e){return e.size>t})):e.size>t;a?this.$emit("oversize",Object.assign({file:e},this.getDetail())):("function"===typeof i&&i(e,this.getDetail()),this.$emit("afterRead",Object.assign({file:e},this.getDetail())))},deleteItem:function(e){this.$emit("delete",Object.assign(Object.assign({},this.getDetail(e)),{file:this.fileList[e]}))},onPreviewImage:function(e){var t=this;e.isImage&&this.previewFullImage&&uni.previewImage({urls:this.lists.filter((function(e){return"image"===t.accept||uni.$u.test.image(e.url||e.thumb)})).map((function(e){return e.url||e.thumb})),current:e.url||e.thumb,fail:function(){uni.$u.toast("预览图片失败")}})},onPreviewVideo:function(e){if(this.data.previewFullImage){var t=e.currentTarget.dataset.index,i=this.data.lists;wx.previewMedia({sources:i.filter((function(e){return isVideoFile(e)})).map((function(e){return Object.assign(Object.assign({},e),{type:"video"})})),current:t,fail:function(){uni.$u.toast("预览视频失败")}})}},onClickPreview:function(e){var t=e.currentTarget.dataset.index,i=this.data.lists[t];this.$emit("clickPreview",Object.assign(Object.assign({},i),this.getDetail(t)))}}};t.default=r},1226:function(e,t,i){var a=i("24fb");t=a(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */uni-view[data-v-58cfe1e6], uni-scroll-view[data-v-58cfe1e6], uni-swiper-item[data-v-58cfe1e6]{display:flex;flex-direction:column;flex-shrink:0;flex-grow:0;flex-basis:auto;align-items:stretch;align-content:flex-start}.u-upload[data-v-58cfe1e6]{display:flex;flex-direction:column;flex:1}.u-upload__wrap[data-v-58cfe1e6]{display:flex;flex-direction:row;flex-wrap:wrap;flex:1}.u-upload__wrap__preview[data-v-58cfe1e6]{border-radius:%?4?%;margin:0 %?12?% %?12?% 0;position:relative;overflow:hidden;display:flex;flex-direction:row}.u-upload__wrap__preview__image[data-v-58cfe1e6]{width:%?160?%;height:%?160?%}.u-upload__wrap__preview__other[data-v-58cfe1e6]{width:%?160?%;height:%?160?%;background-color:#f2f2f2;flex:1;display:flex;flex-direction:column;justify-content:center;align-items:center}.u-upload__wrap__preview__other__text[data-v-58cfe1e6]{font-size:%?22?%;color:#909193;margin-top:%?4?%}.u-upload__deletable[data-v-58cfe1e6]{position:absolute;top:0;right:0;background-color:#373737;height:%?48?%;width:%?48?%;display:flex;flex-direction:row;border-bottom-left-radius:%?200?%;align-items:center;justify-content:center;z-index:3}.u-upload__deletable__icon[data-v-58cfe1e6]{position:absolute;-webkit-transform:scale(.7);transform:scale(.7);top:0;right:0;top:1px;right:0}.u-upload__success[data-v-58cfe1e6]{position:absolute;bottom:0;right:0;display:flex;flex-direction:row;border-style:solid;border-top-color:transparent;border-left-color:transparent;border-bottom-color:#5ac725;border-right-color:#5ac725;border-width:%?18?%;align-items:center;justify-content:center}.u-upload__success__icon[data-v-58cfe1e6]{position:absolute;-webkit-transform:scale(.7);transform:scale(.7);bottom:%?-20?%;right:%?-20?%}.u-upload__status[data-v-58cfe1e6]{position:absolute;top:0;bottom:0;left:0;right:0;background-color:rgba(0,0,0,.5);display:flex;flex-direction:column;align-items:center;justify-content:center}.u-upload__status__icon[data-v-58cfe1e6]{position:relative;z-index:1}.u-upload__status__message[data-v-58cfe1e6]{font-size:%?24?%;color:#fff;margin-top:%?10?%}.u-upload__button[data-v-58cfe1e6]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:%?160?%;height:%?160?%;background-color:#f4f5f7;border-radius:%?4?%;margin:0 %?16?% %?16?% 0;box-sizing:border-box}.u-upload__button__text[data-v-58cfe1e6]{font-size:%?22?%;color:#909193;margin-top:%?4?%}.u-upload__button--hover[data-v-58cfe1e6]{background-color:#e6e7e9}.u-upload__button--disabled[data-v-58cfe1e6]{opacity:.5}',""]),e.exports=t},"18fe":function(e,t,i){"use strict";var a=i("b633"),n=i.n(a);n.a},"20a6":function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var a={uIcon:i("32e1").default,uLoadingIcon:i("7148").default},n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"u-upload",style:[e.$u.addStyle(e.customStyle)]},[i("v-uni-view",{staticClass:"u-upload__wrap"},[e.previewImage?e._l(e.lists,(function(t,a){return i("v-uni-view",{key:a,staticClass:"u-upload__wrap__preview"},[t.isImage||t.type&&"image"===t.type?i("v-uni-image",{staticClass:"u-upload__wrap__preview__image",style:[{width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)}],attrs:{src:t.thumb||t.url,mode:e.imageMode},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.onPreviewImage(t)}}}):i("v-uni-view",{staticClass:"u-upload__wrap__preview__other"},[i("u-icon",{attrs:{color:"#80CBF9",size:"52",name:t.isVideo||t.type&&"video"===t.type?"movie":"folder"}}),i("v-uni-text",{staticClass:"u-upload__wrap__preview__other__text"},[e._v(e._s(t.isVideo||t.type&&"video"===t.type?"视频":"文件"))])],1),"uploading"===t.status||"failed"===t.status?i("v-uni-view",{staticClass:"u-upload__status"},[i("v-uni-view",{staticClass:"u-upload__status__icon"},["failed"===t.status?i("u-icon",{attrs:{name:"close-circle",color:"#ffffff",size:"50"}}):i("u-loading-icon",{attrs:{size:"44",mode:"circle",color:"#ffffff"}})],1),t.message?i("v-uni-text",{staticClass:"u-upload__status__message"},[e._v(e._s(t.message))]):e._e()],1):e._e(),"uploading"!==t.status&&(e.deletable||t.deletable)?i("v-uni-view",{staticClass:"u-upload__deletable",on:{click:function(t){t.stopPropagation(),arguments[0]=t=e.$handleEvent(t),e.deleteItem(a)}}},[i("v-uni-view",{staticClass:"u-upload__deletable__icon"},[i("u-icon",{attrs:{name:"close",color:"#ffffff",size:"40"}})],1)],1):e._e(),"success"===t.status?i("v-uni-view",{staticClass:"u-upload__success"},[i("v-uni-view",{staticClass:"u-upload__success__icon"},[i("u-icon",{attrs:{name:"checkmark",color:"#ffffff",size:"24"}})],1)],1):e._e()],1)})):e._e(),e.isInCount?[e.$slots.default||e.$slots.$default?i("v-uni-view",{on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseFile.apply(void 0,arguments)}}},[e._t("default")],2):i("v-uni-view",{staticClass:"u-upload__button",class:[e.disabled&&"u-upload__button--disabled"],style:[{width:e.$u.addUnit(e.width),height:e.$u.addUnit(e.height)}],attrs:{"hover-class":e.disabled?"":"u-upload__button--hover","hover-stay-time":"150"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.chooseFile.apply(void 0,arguments)}}},[i("u-icon",{attrs:{name:e.uploadIcon,size:"52",color:e.uploadIconColor}}),e.uploadText?i("v-uni-text",{staticClass:"u-upload__button__text"},[e._v(e._s(e.uploadText))]):e._e()],1)]:e._e()],2)],1)},o=[]},"36e4":function(e,t,i){var a=i("f2bf");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("dc3af314",a,!0,{sourceMap:!1,shadowMode:!1})},"67bd":function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={watch:{accept:{immediate:!0,handler:function(e){"all"!==e&&"media"!==e||uni.$u.error("只有微信小程序才支持把accept配置为all、media之一")}}}};t.default=a},"7e93":function(e,t,i){"use strict";var a=i("4ea4");i("4160"),i("d3b7"),i("3ca3"),i("498a"),i("159b"),i("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.uploadFile=void 0;var n=a(i("7615")),o=(n.default.apiDomain,function(e){return new Promise((function(t,i){uni.showLoading({title:"正在上传..."});var a=[],n=[];e.forEach((function(e){a.push(u(e).then((function(e){n.push(e)})))})),Promise.all(a).then((function(){uni.hideLoading(),t(n)})).catch((function(e){uni.hideLoading(),i(e)}))}))}),u=function(e){return new Promise((function(t,i){uni.uploadFile({url:"http://upload.tuuz.cc:81/v1/file/index/up_complete?token=tc",file:e,name:"file",formData:{},success:function(e){console.log(e),e.data?("string"==typeof e.data&&(e.data=JSON.parse(e.data.trim())),t(e.data.data.url)):(uni.$u.toast(e.errMsg),i())},fail:function(e){i(e)}})}))};t.uploadFile=u;var r=o;t.default=r},"7f48":function(e,t,i){"use strict";var a=i("36e4"),n=i.n(a);n.a},"821e":function(e,t,i){"use strict";var a=i("4ea4");i("4160"),i("a434"),i("d3b7"),i("3ca3"),i("159b"),i("ddb0"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i("37b7"),o=a(i("7615")),u=a(i("7e93")),r={data:function(){return{currCate:"",categorys:o.default.categorys,fileList:[]}},onLoad:function(e){this.currCate=decodeURIComponent(e.currCate)},methods:{doSub:function(){var e=this;if(this.fileList.length){var t=[];this.fileList.forEach((function(i){t.push((0,n.upload)({type:"照片墙",category:e.currCate,term_id:e.$store.state.common.currTermInfo.id,title:"",url:i.url}))})),Promise.all(t).then((function(t){e.$evalPageMethods("pages/tabbar/tabbar","evalPullDownRefresh"),uni.navigateBack()}))}else uni.$u.toast("请上传照片")},afterRead:function(e){var t=this;(0,u.default)(e.file).then((function(e){e.forEach((function(e){t.fileList.push({url:e})}))}))},deletePic:function(e){this.fileList.splice(e.index,1)}}};t.default=r},"8b28":function(e,t,i){"use strict";i.r(t);var a=i("821e"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a},"987a":function(e,t,i){"use strict";i.r(t);var a=i("20a6"),n=i("facd");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("18fe");var u,r=i("f0c5"),s=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"58cfe1e6",null,!1,a["a"],u);t["default"]=s.exports},b633:function(e,t,i){var a=i("1226");"string"===typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);var n=i("4f06").default;n("23835b59",a,!0,{sourceMap:!1,shadowMode:!1})},b69b:function(e,t,i){"use strict";var a=i("4ea4");i("caad"),i("d81d"),i("13d5"),i("b64b"),i("d3b7"),i("25f0"),i("2532"),Object.defineProperty(t,"__esModule",{value:!0}),t.chooseFile=l;var n=a(i("5530"));function o(e,t){return["[object Object]","[object File]"].includes(Object.prototype.toString.call(e))?Object.keys(e).reduce((function(i,a){return t.includes(a)||(i[a]=e[a]),i}),{}):{}}function u(e){return e.tempFiles}function r(e){return[(0,n.default)((0,n.default)({},o(e,["tempFilePath","thumbTempFilePath","errMsg"])),{},{type:"video",url:e.tempFilePath,thumb:e.thumbTempFilePath,size:e.size,name:e.name})]}function s(e){return e.tempFiles.map((function(e){return(0,n.default)((0,n.default)({},o(e,["path"])),{},{url:e.path,size:e.size,name:e.name,type:e.type})}))}function l(e){var t=e.accept,i=e.multiple,a=e.capture,n=e.compressed,o=e.maxDuration,l=e.sizeType,c=e.camera,d=e.maxCount;return new Promise((function(e,f){switch(t){case"image":uni.chooseImage({count:i?Math.min(d,9):1,sourceType:a,sizeType:l,success:function(t){return e(u(t))},fail:f});break;case"video":uni.chooseVideo({sourceType:a,compressed:n,maxDuration:o,camera:c,success:function(t){return e(r(t))},fail:f});break;case"file":uni.chooseFile({count:i?d:1,type:t,success:function(t){return e(s(t))},fail:f});break;default:uni.chooseFile({count:i?d:1,type:"all",success:function(t){return e(s(t))},fail:f})}}))}},e4e0:function(e,t,i){"use strict";i.r(t);var a=i("e58b"),n=i("8b28");for(var o in n)"default"!==o&&function(e){i.d(t,e,(function(){return n[e]}))}(o);i("7f48");var u,r=i("f0c5"),s=Object(r["a"])(n["default"],a["b"],a["c"],!1,null,"bd065742",null,!1,a["a"],u);t["default"]=s.exports},e58b:function(e,t,i){"use strict";i.d(t,"b",(function(){return n})),i.d(t,"c",(function(){return o})),i.d(t,"a",(function(){return a}));var a={uUpload:i("987a").default,uScrollList:i("99e1").default,uButton:i("d102").default},n=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-uni-view",{staticClass:"add-article-container"},[i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"form-item-title"},[e._v("添加照片("+e._s(e.fileList.length)+"/9)")]),i("v-uni-view",{staticClass:"form-item-input"},[i("u-upload",{attrs:{multiple:!0,width:"224",height:"224",fileList:e.fileList,maxCount:9},on:{afterRead:function(t){arguments[0]=t=e.$handleEvent(t),e.afterRead.apply(void 0,arguments)},delete:function(t){arguments[0]=t=e.$handleEvent(t),e.deletePic.apply(void 0,arguments)}}})],1)],1),i("v-uni-view",{staticClass:"form-item"},[i("v-uni-view",{staticClass:"form-item-title"},[e._v("选择照片所属分类")]),i("v-uni-view",{staticClass:"form-item-input"},[i("u-scroll-list",{attrs:{indicator:!1}},[i("v-uni-view",{staticClass:"scroll-list",staticStyle:{"flex-direction":"row"}},[i("v-uni-view",{staticClass:"scroll-list-item ",class:{active:""==e.currCate},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.currCate=""}}},[e._v("全部")]),e._l(e.categorys,(function(t,a){return i("v-uni-view",{key:a,staticClass:"scroll-list-item ",class:{active:e.currCate==t},on:{click:function(i){arguments[0]=i=e.$handleEvent(i),e.currCate=t}}},[e._v(e._s(t))])}))],2)],1)],1)],1),i("u-button",{attrs:{throttleTime:500,shape:"circle",type:"primary",customStyle:"margin:80rpx 24rpx;width:702rpx;\n\theight: 98rpx;font-size:30rpx;"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.doSub.apply(void 0,arguments)}}},[e._v("上传")])],1)},o=[]},e600:function(e,t,i){"use strict";i("a9e3"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a={props:{accept:{type:String,default:uni.$u.props.upload.accept},capture:{type:[String,Array],default:uni.$u.props.upload.capture},compressed:{type:Boolean,default:uni.$u.props.upload.compressed},camera:{type:String,default:uni.$u.props.upload.camera},maxDuration:{type:Number,default:uni.$u.props.upload.maxDuration},uploadIcon:{type:String,default:uni.$u.props.upload.uploadIcon},uploadIconColor:{type:String,default:uni.$u.props.upload.uploadIconColor},useBeforeRead:{type:Boolean,default:uni.$u.props.upload.useBeforeRead},afterRead:{type:Function,default:null},beforeRead:{type:Function,default:null},previewFullImage:{type:Boolean,default:uni.$u.props.upload.previewFullImage},maxCount:{type:[String,Number],default:uni.$u.props.upload.maxCount},disabled:{type:Boolean,default:uni.$u.props.upload.disabled},imageMode:{type:String,default:uni.$u.props.upload.imageMode},name:{type:String,default:uni.$u.props.upload.name},sizeType:{type:Array,default:uni.$u.props.upload.sizeType},multiple:{type:Boolean,default:uni.$u.props.upload.multiple},deletable:{type:Boolean,default:uni.$u.props.upload.deletable},maxSize:{type:[String,Number],default:uni.$u.props.upload.maxSize},fileList:{type:Array,default:uni.$u.props.upload.fileList},uploadText:{type:String,default:uni.$u.props.upload.uploadText},width:{type:[String,Number],default:uni.$u.props.upload.width},height:{type:[String,Number],default:uni.$u.props.upload.height},previewImage:{type:Boolean,default:uni.$u.props.upload.previewImage}}};t.default=a},f2bf:function(e,t,i){var a=i("24fb");t=a(!1),t.push([e.i,'@charset "UTF-8";\r\n/**\r\n * 这里是uni-app内置的常用样式变量\r\n *\r\n * uni-app 官方扩展插件及插件市场（https://ext.dcloud.net.cn）上很多三方插件均使用了这些样式变量\r\n * 如果你是插件开发者，建议你使用scss预处理，并在插件代码中直接使用这些变量（无需 import 这个文件），方便用户通过搭积木的方式开发整体风格一致的App\r\n *\r\n */\r\n/**\r\n * 如果你是App开发者（插件使用者），你可以通过修改这些变量来定制自己的插件主题，实现自定义主题功能\r\n *\r\n * 如果你的项目同样使用了scss预处理，你也可以直接在你的 scss 代码中使用如下变量，同时无需 import 这个文件\r\n */\r\n/* 颜色变量 */\r\n/* 行为相关颜色 */\r\n/* 文字基本颜色 */\r\n/* 背景颜色 */\r\n/* 边框颜色 */\r\n/* 尺寸变量 */\r\n/* 文字尺寸 */\r\n/* 图片尺寸 */\r\n/* Border Radius */\r\n/* 水平间距 */\r\n/* 垂直间距 */\r\n/* 透明度 */\r\n/* 文章场景相关 */.add-article-container[data-v-bd065742]{min-height:100vh}.add-article-container .form-item[data-v-bd065742]{padding:%?0?% %?24?%;margin-top:%?48?%}.add-article-container .form-item-title[data-v-bd065742]{font-size:%?26?%;color:#303133;font-weight:700}.add-article-container .form-item-input[data-v-bd065742]{margin-top:%?24?%}.add-article-container .form-item-input .scroll-list[data-v-bd065742]{background:#fff;display:flex;align-items:center}.add-article-container .form-item-input .scroll-list-item[data-v-bd065742]{min-width:%?158?%;height:%?64?%;line-height:%?64?%;background:#f7f7f7;border-radius:%?16?%;text-align:center;font-size:%?26?%;color:#303133;font-weight:700;margin-right:%?24?%}.add-article-container .form-item-input .scroll-list-item.active[data-v-bd065742]{color:#0086ff;border:%?2?% solid #0086ff;background:rgba(0,134,255,.1);box-sizing:border-box}',""]),e.exports=t},facd:function(e,t,i){"use strict";i.r(t);var a=i("04d1"),n=i.n(a);for(var o in a)"default"!==o&&function(e){i.d(t,e,(function(){return a[e]}))}(o);t["default"]=n.a}}]);